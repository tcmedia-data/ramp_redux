//DFP_General_LevelsAll_Monthly_v12
//COMBINE DFP Level0 AND Level1
SELECT 
TransactionDate,
Ad_unit_1,
Ad_unit_2,
Ad_unit_3,
Line_item_type,
placement_name,
placement_id,
AliasName,
SiteID,
Creative_size,
Creative_size_FINAL,
Advertiser,
OrderName,
Salesperson,
Line_item,
Product_template,
Master_Companion_Creative,
Ad_unit_ID_1,
Ad_unit_ID_2,
Ad_unit_ID_3,
Advertiser_ID,
Order_ID,
Salesperson_ID,
Line_item_ID,
Product_template_ID,
Master_Companion_CreativeID,
Order_start_date,
Order_end_date,
Order_PO_number,
Agency,
Agency_ID,
Trafficker,
Secondary_traffickers,
Delivery_pacing,
Frequency_cap,
Line_item_start_date,
Line_item_end_date,
Cost_type,
Rate_CA,
Goal_quantity,
Line_item_lifetime_impressions,
Line_item_lifetime_clicks,
Line_item_priority,
Contracted_quantity,
Discount,
Master_Companion,
Name_Comments,
Audience_Segment,
LineItem_Type,
LineItem_Type_product,
Total_Active_View_eligible_impressions,
Total_Active_View_viewable_impressions,
PlatformNAME,
PlatformID,
axLineItemTypeNAME,
axLineItemTypeID,
axImpTypeNAME,
axImpTypeID,
axMediaTypeNAME,
axMediaTypeID,
CamTypeNAME,
CamTypeID,
RevTypeNAME,
RevTypeID,
ManagedNAME,
ManagedID,
AdTypeNAME,
AdTypeID,
TechFee,
DataSource,
LevelOne,
ID1,
ID2,
AssociatedBU,
PartnershipType,
SiteAliasID,
AccountName,
AccountID,
PublisherName,
PublisherID,
Site,
Site_ID,
Site_ID_calc,
Adv,
DisplayRevShare,
TCAdvertiserGroup,
TCCampSrc,
ImpressionSource,
Passback,
ContainerSource,
Ad_server_impressions,
Ad_server_clicks,
AdSense_impressions,
AdSense_clicks,
Ad_Exchange_impressions,
Ad_Exchange_clicks,
Ad_server_CPM_and_CPC_revenue_CA,
Ad_server_CPD_revenue_CA,
AdSense_revenue_CA,
Ad_Exchange_revenue_CA,
Total_CPM_and_CPC_revenue_CA,
Total_impressions,
Total_clicks,
IMPS_Final,
CLICKS_Final,
REVS_CPMCPC_Final,
REVS_CPD_Final
FROM 

//IMPORTANT >> IF REPROCESS, LINE 34 SHOULD BE : STRING('') AS Agency_ID,
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level0_, TIMESTAMP('2016-06-01'), TIMESTAMP('2016-06-30'))),
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level1_, TIMESTAMP('2016-06-01'), TIMESTAMP('2016-06-30')))

//IMPORTANT >> IF REPROCESS, LINE 34 SHOULD BE : STRING('') AS Agency_ID
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level0_, TIMESTAMP('2016-07-01'), TIMESTAMP('2016-07-31'))),
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level1_, TIMESTAMP('2016-07-01'), TIMESTAMP('2016-07-31')))

//IMPORTANT >> IF REPROCESS, LINE 34 SHOULD BE : STRING('') AS Agency_ID
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level0_, TIMESTAMP('2016-08-01'), TIMESTAMP('2016-08-31'))),
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level1_, TIMESTAMP('2016-08-01'), TIMESTAMP('2016-08-31')))

//IMPORTANT >> IF REPROCESS, LINE 34 SHOULD BE : Agency_ID
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level0_, TIMESTAMP('2016-09-01'), TIMESTAMP('2016-09-30'))),
--(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level1_, TIMESTAMP('2016-09-01'), TIMESTAMP('2016-09-30')))

//IMPORTANT >> IF REPROCESS, LINE 34 SHOULD BE : Agency_ID
(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level0_, TIMESTAMP('2016-10-01'), TIMESTAMP('2016-10-31'))),
(TABLE_DATE_RANGE( ManagedServices_DFP.DFP_GENERAL_Level1_, TIMESTAMP('2016-10-01'), TIMESTAMP('2016-10-31')))

WHERE TransactionDate IS NOT NULL
//LIMIT 100
//Save to ManagedServices_DFP.DFP_GENERAL_LevelALL_2016xx01
