//APNX_AllDates_Monthly_v12
//COMBINE APNX Daily Files into one MONTHLY

SELECT 
TransactionDate,
Ad_unit_1,
Ad_unit_2,
Ad_unit_3,
Line_item_type,
placement_name,
placement_id,
AliasName,
SiteID,
Creative_size,
Creative_size_FINAL,
Advertiser,
OrderName,
Salesperson,
Line_item,
Product_template,
Master_Companion_Creative,
Ad_unit_ID_1,
Ad_unit_ID_2,
Ad_unit_ID_3,
Advertiser_ID,
Order_ID,
Salesperson_ID,
Line_item_ID,
Product_template_ID,
Master_Companion_CreativeID,
Order_start_date,
Order_end_date,
Order_PO_number,
Agency,
Agency_ID,
Trafficker,
Secondary_traffickers,
Delivery_pacing,
Frequency_cap,
Line_item_start_date,
Line_item_end_date,
Cost_type,
Rate_CA,
Goal_quantity,
Line_item_lifetime_impressions,
Line_item_lifetime_clicks,
Line_item_priority,
Contracted_quantity,
Discount,
Master_Companion,
Name_Comments,
Audience_Segment,
LineItem_Type,
LineItem_Type_product,
Total_Active_View_eligible_impressions,
Total_Active_View_viewable_impressions,
PlatformNAME,
PlatformID,
axLineItemTypeNAME,
axLineItemTypeID,
axImpTypeNAME,
axImpTypeID,
axMediaTypeNAME,
axMediaTypeID,
CamTypeNAME,
CamTypeID,
RevTypeNAME,
RevTypeID,
ManagedNAME,
ManagedID,
AdTypeNAME,
AdTypeID,
TechFee,
DataSource,
STRING(LevelOne) AS LevelOne,
STRING(ID1) AS ID1,
STRING(ID2) AS ID2,
AssociatedBU,
PartnershipType,
SiteAliasID,
AccountName,
AccountID,
PublisherName,
PublisherID,
Site,
Site_ID,
Site_ID_calc,
Adv,
DisplayRevShare,
TCAdvertiserGroup,
TCCampSrc,
ImpressionSource,
Passback,
ContainerSource,
Ad_server_impressions,
Ad_server_clicks,
AdSense_impressions,
AdSense_clicks,
Ad_Exchange_impressions,
Ad_Exchange_clicks,
Ad_server_CPM_and_CPC_revenue_CA,
Ad_server_CPD_revenue_CA,
AdSense_revenue_CA,
Ad_Exchange_revenue_CA,
Total_CPM_and_CPC_revenue_CA,
Total_impressions,
Total_clicks,
IMPS_Final,
CLICKS_Final,
REVS_CPMCPC_Final,
REVS_CPD_Final
FROM 
--(TABLE_DATE_RANGE( ManagedServices_APNX.APPNEXUS_NETWORK_JOIN_, TIMESTAMP('2016-06-01'), TIMESTAMP('2016-06-30')))
--(TABLE_DATE_RANGE( ManagedServices_APNX.APPNEXUS_NETWORK_JOIN_, TIMESTAMP('2016-07-01'), TIMESTAMP('2016-07-31')))
--(TABLE_DATE_RANGE( ManagedServices_APNX.APPNEXUS_NETWORK_JOIN_, TIMESTAMP('2016-08-01'), TIMESTAMP('2016-08-31')))
--(TABLE_DATE_RANGE( ManagedServices_APNX.APPNEXUS_NETWORK_JOIN_, TIMESTAMP('2016-09-01'), TIMESTAMP('2016-09-30')))
(TABLE_DATE_RANGE( ManagedServices_APNX.APPNEXUS_NETWORK_JOIN_, TIMESTAMP('2016-10-01'), TIMESTAMP('2016-10-31')))

WHERE TransactionDate IS NOT NULL

//Save Output to: ManagedServices_APNX.APPNEXUS_NETWORK_Monthly_2016xx01
